# 📱 텔레그램 알림 설정 가이드

## 🎯 텔레그램으로 받을 수 있는 알림들

- **🟢 매수/매도 신호**: 실시간 주식 매매 신호
- **📊 일일 분석 요약**: 하루 종료 후 전체 분석 결과  
- **🇰🇷🇺🇸 시장 현황**: 한국/미국 시장 개장/마감 알림
- **🚨 시스템 오류**: 중요한 시스템 이슈 알림

## 🚀 설정 방법

### 1단계: 텔레그램 봇 생성

1. **BotFather 찾기**
   - 텔레그램 앱에서 `@BotFather` 검색
   - 대화 시작하고 `/start` 입력

2. **봇 생성하기**
   ```
   /newbot
   ```
   - 봇 이름: `Stock Analyzer Bot` (원하는 이름)
   - 봇 사용자명: `your_stock_bot` (고유해야 함, `bot`으로 끝나야 함)

3. **봇 토큰 복사**
   - BotFather가 토큰을 제공합니다
   - 형태: `1234567890:ABCdefGHIjklMNOPqrsTUVwxyz`
   - **⚠️ 이 토큰을 안전하게 보관하세요!**

### 2단계: 알림 방식 선택

#### 방법 A: 개인 메시지로 받기 (간단)
1. 생성한 봇과 개인 대화 시작
2. `/start` 메시지 전송
3. 단계 3으로 이동

#### 방법 B: 전용 채널 만들기 (추천) 
1. **새 채널 생성**
   - 텔레그램에서 "새 채널" 선택
   - 채널명: `📈 주식 알림` (원하는 이름)
   - **Private 채널**로 설정

2. **봇을 채널 관리자로 추가**
   - 채널 설정 ⚙️ → 관리자 → 관리자 추가
   - 생성한 봇 검색해서 추가
   - **메시지 게시** 권한 체크 ✅

3. **채널에 테스트 메시지 전송**
   - 채널에서 아무 메시지나 전송 (예: "테스트")

### 3단계: Chat ID 확인 및 설정

1. **설정 도구 실행**
   ```bash
   cd /Users/dojes/Documents/synology/code/stock-analyzer
   python scripts/setup_telegram.py
   ```

2. **봇 토큰 입력**
   - 1단계에서 받은 토큰 입력

3. **Chat ID 확인**
   - 스크립트가 자동으로 Chat ID들을 찾아줍니다
   - 개인 대화: 숫자 ID (예: `123456789`)
   - 채널: 음수 ID (예: `-1001234567890`)

4. **사용할 Chat ID 선택**
   - 원하는 Chat ID 입력
   - 테스트 메시지가 전송됩니다

### 4단계: 환경 변수 설정

스크립트 실행 후 출력되는 설정을 `.env` 파일에 추가:

```bash
# 텔레그램 알림 설정 (모바일 알림, 긴급 시장 상황 알림용)
TELEGRAM_ENABLED=true                      # 텔레그램 알림 활성화 여부
TELEGRAM_BOT_TOKEN=1234567890:ABCdefGHI... # 텔레그램 봇 토큰
TELEGRAM_CHAT_ID=-1001234567890            # 텔레그램 채팅방 ID
```

## ✅ 테스트 해보기

```bash
python app/services/telegram_service.py
```

성공하면 텔레그램으로 테스트 메시지가 옵니다! 🎉

## 📱 실제 알림 예시

### 매수/매도 신호
```
🟢 주식 알림 🟢

📊 종목: 삼성전자 (005930)
💰 현재가: 75,000원  
📈 변동률: +2.5%
🎯 신호: BUY
🔍 신뢰도: 85.0%

⏰ 2025-09-22 09:30:00
```

### 일일 요약
```
📊 일일 주식 분석 요약 📊

📅 날짜: 2025-09-22
🔍 분석 종목: 200개
🟢 매수 신호: 15개
🔴 매도 신호: 8개  
🎯 평균 정확도: 72.5%

🏆 오늘의 추천 종목:
1. 삼성전자 (기대수익률: +3.2%, 신뢰도: 85.0%)
2. LG화학 (기대수익률: +2.8%, 신뢰도: 78.5%)
...
```

## 🔧 문제 해결

### "봇을 찾을 수 없습니다"
- 봇 사용자명이 `bot`으로 끝나는지 확인
- 사용자명이 이미 사용 중인지 확인

### "메시지 전송 실패"  
- 봇 토큰이 정확한지 확인
- Chat ID가 올바른지 확인
- 채널의 경우 봇이 관리자로 추가되었는지 확인

### "Chat ID를 찾을 수 없습니다"
- 봇과 대화를 시작했는지 확인 (`/start` 전송)
- 채널의 경우 메시지를 전송했는지 확인

## 💡 팁

1. **채널 사용 추천**: 개인 메시지보다 전용 채널이 깔끔함
2. **알림 시간**: 한국 시장 기준으로 설정됨  
3. **여러 채널**: 긴급 알림용/일반 알림용으로 분리 가능
4. **그룹 추가**: 팀원들과 알림 공유 가능

---

설정 완료 후 시스템을 재시작하면 텔레그램 알림이 활성화됩니다! 📱✨
